{% extends "crawler/base.html" %}
{% load staticfiles %}

{% block title %}
Attempt {{attempt.id}}
{% endblock %}

{% block main %}
<div style="background-color:black; color:white">
    <h1>
<a href="{% url 'home' %}">Database Web Crawler</a> >> <a href="{% url 'repositories' %}?{{ queries.urlencode }}#{{attempt.repo.full_name}}">Repositories</a>
>> <a href="{% url 'repository' attempt.repo.get_user_name attempt.repo.get_repo_name %}?{{ queries.urlencode }}#{{ attempt.id }}">{{attempt.repo.full_name}}</a>
>> Attempt {{attempt.id}}
</h1>
</div>

<h2 class="sub-header">Attempt Detail</h2>




<div class="col-xs-6">
<div class="table-responsive">
<table class="table table-bordered table-striped">
<colgroup>
<col class="col-xs-1">
<col class="col-xs-7">
</colgroup>
<tbody>
<tr>
<td>
<code>Attempt ID</code>
</td>
<td>{{attempt.id}}</td>
</tr>
<tr>
<td>
<code>Repository</code>
</td>
<td>{{attempt.repo.full_name}}</td>
</tr>
<tr>
<td>
<code>Sha Code</code>
</td>
<td>{{attempt.sha}}</td>
</tr>
<tr>
<td>
<code>Repository Type</code>
</td>
<td>{{attempt.repo.repo_type.name}}</td>
</tr>
<tr>
<td>
<code>Result</code>
</td>
                    {% if not attempt %}
                        <td><span class="label label-info">No Attempt</span></td>
                    {% elif attempt.result.name == "Success" %}
                        <td><a href="{% url 'attempt' attempt.id %}" class="label label-success">{{attempt.result.name}}</a></td>
                    {% elif attempt.result.name == "Running Error" or attempt.result.name == "Missing Dependencies" %}
                        <td><a href="{% url 'attempt' attempt.id %}" class="label label-danger">{{attempt.result.name}}</a></td>
                    {% elif attempt.result.name == "Deploying" %}
                        <td><a href="{% url 'attempt' attempt.id %}" class="label label-info">{{attempt.result.name}}</a></td>
                    {% else %}
                        <td><a href="{% url 'attempt' attempt.id %}" class="label label-warning">{{attempt.result.name}}</a></td>
                    {% endif %}
</tr>
</tbody>
</table>
</div>
</div>




<div class="col-xs-6">
<div class="table-responsive">
<table class="table table-bordered table-striped">
<colgroup>
<col class="col-xs-1">
<col class="col-xs-7">
</colgroup>
<tbody>
<tr>
<td>
<code>Deployment Host</code>
</td>
<td>{{attempt.hostname}}</td>
</tr>
<tr>
<td>
<code>Start Time</code>
</td>
{% if attempt.start_time %}
    <td>{{ attempt.start_time|date:'Y-m-d H:i:s' }}</td>
{% else %}
<td>-</td>
{% endif %}
</tr>
<tr>
<td>
<code>Duration</code>
</td>
{% if attempt.duration %}
<td>{{ attempt.duration }}s</td>
{% else %}
<td>-</td>
{% endif %}
</tr>
<tr>
<td>
<code>Database</code>
</td>
<td>{{attempt.database.name}}</td>
</tr>
<tr>
<td>
<code>Base Directory</code>
</td>
<td>{{attempt.base_dir}}</td>
</tr>
</tbody>
</table>
</div>
</div>






<h2 class="sub-header">Dependencies</h2>
<div class="table-responsive">
    <table class="table table-striped">
        <thead>
            <tr>
                <th>Package</th>
                <th>Source</th>
            </tr>
        </thead>
        <tbody>
            {% if dependencies %}
            {% for dependency in dependencies %}
            <tr>
                <td>{{ dependency.package.name }}=={{ dependency.package.version }}</td>
                <td>{{ dependency.source.name }}</td>
            </tr>
            {% endfor %}
            {% endif %}
        </tbody>
    </table>
</div>

<h2 class="sub-header">Log</h2>
<pre>{{ attempt.log }}</pre>
{% endblock %}
