{% extends "base.html" %}
{% load staticfiles %}

{% block title %}
Benchmarks &raquo; Database Application Crawler
{% endblock %}

{% block main %}
{% include "status_codes.html" %}

<h2 class="page-header">Benchmarks</h2>

<form action="{% url 'benchmarks' %}" method="get">
    <div style="float:left">
    {{ result_form }}
    </div>

    <div style="float:left">
    {{ type_form }}
    </div>

    <div style="float:left">
        <b>Name:</b>
        <input type="Search" placeholder='Search by full name' value='{{ search }}' class="form-control" name='search'/>
        <div style="margin: 20px">
            <input class="btn btn-primary btn-lg" type="submit" value="Filter"/>
        </div>
    </div>
</form>

<div class="table-responsive" style="clear:both;">
    <table class="table table-striped" style="word-break:break-all">
        <thead>
            <tr>
                <th class="col-md-2">
                    <a href="?order_by={% if order_by == "attempt__id" %}-{% endif %}attempt__id&amp;{{ queries_no_page_order.urlencode }}">Attempt
                </th>
                <th class="col-md-2">
                    <a href="?order_by={% if order_by == "repo_type__name" %}-{% endif %}repo_type__name&amp;{{ queries_no_page_order.urlencode }}">Type
                </th>
                <th class="col-md-4">
                    <a href="?order_by={% if order_by != "-result" %}-{% endif %}result&amp;{{ queries_no_page_order.urlencode }}">Result
                </th>
                <th class="col-md-4">
                    <a href="?order_by={% if order_by != "-stop_time" %}-{% endif %}stop_time&amp;{{queries_no_page_order.urlencode }}">Updated
                </th>
            </tr>
        </thead>
        <tbody>
            {% if benchmarks %}
                {% for benchmark in benchmarks %}
                <tr>
                    <td>{{ benchmark.attempt.id }}</a></td>
                    
                    <td><img src="{% static benchmark.attempt.repo.project_type.logo %}" alt="{{ benchmark.attempt.repo.project_type.name }}" title="{{ benchmark.attempt.repo.project_type.name }}" class="projecttype-logo" /></td>

                    <td>
                        <a href="{% url 'attempt' benchmark.id %}?{{ queries.urlencode }}" class="label label-{{ benchmark.result_label }}">{{ benchmark.result_name}}</a>
                        <a href="#" data-toggle="modal" data-target="#statusModal">?</a>
                    </td>
                    
                    <td>{{ benchmark.stop_time|date:'Y-m-d H:i:s' }}</td>
                </tr>
                {% endfor %}
            {% endif %}
        </tbody>
    </table>
</div>

<ul id="pagination" class="pagination-sm"></ul>

<script type='text/javascript'>
    $('#pagination').twbsPagination({
        totalPages: {{ benchmarks.paginator.num_pages }},
        visiblePages: 10,
        href: '?page={% templatetag openvariable %}number{% templatetag closevariable %}&{{ queries_no_page.urlencode }}',
        onPageClick: function (event, page) {
            $('#page-content').text('Page ' + page);
        }
    });
</script>

{% endblock %}
