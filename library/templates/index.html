{% extends "base.html" %}
{% load staticfiles %}

{% block header %}
    <div class="intro-header">
        <div class="container">
            <div class="row">
                <div class="col-lg-12">
                    <div class="intro-message">
<!--                         <img src="{{STATIC_URL}}img/cmdbac-logo-white.png" /> -->
                        <h1>Database Application Catalog</h1>
                        <h3>A repository of ready-to-run database applications for analysis and benchmarking</h3>
                    </div>
                </div>
            </div>
            <hr class="intro-divider">
        </div>
        <!-- /.container -->
    </div>
{% endblock %}

{% block main %}
{% include "attempt_status_codes.html" %}

    <!-- Services Section -->
    <section id="services">
        <div class="container">
            <div class="row">
                <div class="col-lg-12 text-center">
                    <h2 class="section-heading">Services</h2>
                    <h3 class="section-subheading text-muted">Lorem ipsum dolor sit amet consectetur.</h3>
                </div>
            </div>
            <div class="row text-center">
                <div class="col-md-4">
                    <span class="fa-stack fa-4x">
                        <i class="fa fa-circle fa-stack-2x text-primary"></i>
                        <i class="fa fa-cloud-download fa-stack-1x fa-inverse"></i>
                    </span>
                    <h4 class="service-heading">Discovery</h4>
                    <p class="text-muted">Lorem ipsum dolor sit amet, consectetur adipisicing elit. Minima maxime quam architecto quo inventore harum ex magni, dicta impedit.</p>
                </div>
                <div class="col-md-4">
                    <span class="fa-stack fa-4x">
                        <i class="fa fa-circle fa-stack-2x text-primary"></i>
                        <i class="fa fa-gears fa-stack-1x fa-inverse"></i>
                    </span>
                    <h4 class="service-heading">Deployment</h4>
                    <p class="text-muted">Lorem ipsum dolor sit amet, consectetur adipisicing elit. Minima maxime quam architecto quo inventore harum ex magni, dicta impedit.</p>
                </div>
                <div class="col-md-4">
                    <span class="fa-stack fa-4x">
                        <i class="fa fa-circle fa-stack-2x text-primary"></i>
                        <i class="fa fa-bar-chart fa-stack-1x fa-inverse"></i>
                    </span>
                    <h4 class="service-heading">Analysis</h4>
                    <p class="text-muted">Lorem ipsum dolor sit amet, consectetur adipisicing elit. Minima maxime quam architecto quo inventore harum ex magni, dicta impedit.</p>
                </div>
            </div>
        </div>
        <hr class="intro-divider">
    </section>

    <!-- Statistics -->
    <section id="statistics">
        <div class="container">
            <div class="row">
                <div class="col-lg-12 text-center">
                    <h2 class="section-heading">Services</h2>
                    <h3 class="section-subheading text-muted">Lorem ipsum dolor sit amet consectetur.</h3>
                </div>
            </div>
            <div class="row">
                <div class="col-lg-6">
                    <h3 class="sub-header">Catalog Totals</h3>
                    <table class="table table-striped">
                        <thead>
                            <tr>
                                <th></th>
                                <th>Project Type</th>
                                <th><del># of Repo</del></th>
                                <th><del># of Deploy</del></th>
                                <th># of Valid</th>
                                <th># of Success</th>
                                <th>Success Rate</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% if stats %}
                            {% for stat in stats %}
                            <tr>
                                <td><img src="{% static stat.project_type.logo %}" alt="{{ stat.project_type.name }}" title="{{ stat.project_type.name }}" class="projecttype-logo" /></td>
                                <td><a href="{% url 'repositories' %}?types={{ stat.project_type.name }}">{{ stat.project_type.name }}</a></td>
                                <td><del>{{ stat.num_repo }}</del></td>
                                <td><del>{{ stat.num_deploy }}</del></td>
                                <td>{{ stat.num_valid_deploy }}</td>
                                <td>{{ stat.num_suc }}</td>
                                <td>{{ stat.suc_rate }}%</td>
                            </tr>
                            {% endfor %}
                            {% endif %}
                        </tbody>
                    </table>
                </div>
                <div class="col-lg-6">
                    <h3 class="sub-header">Recent Attempts</h3>
                    <table class="table table-striped">
                        <thead>
                            <tr>
                                <th></th>
                                <th>Repository</th>
                                <th>Date</th>
                                <th>Result</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% if attempts %}
                            {% for attempt in attempts %}
                            <tr>
                                <td><img src="{% static attempt.repo.project_type.logo %}" alt="{{ attempt.repo.project_type.name }}" title="{{ attempt.repo.project_type.name }}" class="projecttype-logo" /></td>
                                <td><a href="{% url 'repository' attempt.repo.user_name attempt.repo.repo_name %}">{{ attempt.repo.name }}</a></td>
                                
                                {% if attempt.start_time %}
                                <td>{{ attempt.start_time|date:'Y-m-d H:i:s' }}</td>
                                {% else %}
                                <td>-</td>
                                {% endif %}
                                <td>
                                    <a id="{{attempt.id}}" href="#" data-toggle="modal" data-target="#attemptStatusModal" title="Status Code Information" class="label label-statuscode label-{{ attempt.result_label }}">{{attempt.result_name}}</a>
                                </td>
                            </tr>
                            {% endfor %}
                            {% endif %}
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </section>

    <a href="https://github.com/cmu-db/dbac" class="btn btn-default btn-lg"><i class="fa fa-github fa-fw"></i> <span class="network-name">Github</span></a>


{% endblock %}
